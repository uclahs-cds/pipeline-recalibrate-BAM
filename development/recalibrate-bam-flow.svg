<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1598px" preserveAspectRatio="none" style="width:990px;height:1598px;background:#FFFFFF;" version="1.1" viewBox="0 0 990 1598" width="990px" zoomAndPan="magnify"><defs/><g><ellipse cx="341" cy="48.6982" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><rect fill="none" height="234.7031" style="stroke:#000000;stroke-width:1.5;" width="474" x="104" y="68.6982"/><path d="M302,68.6982 L302,110.5889 L292,120.5889 L104,120.5889 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="162" x="107" y="82.6934">Unparallelized Setup</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151" x="107" y="98.9902">This block is run once</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="188" x="107" y="115.2871">regardless of sample count</text><polygon fill="#F1F1F1" points="300.5,137.5889,381.5,137.5889,393.5,150.3936,381.5,163.1982,300.5,163.1982,288.5,150.3936,300.5,137.5889" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="74" x="300.5" y="147.7993">Parallelize by</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="81" x="300.5" y="160.604">chromosome?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="267.5" y="147.7993">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="15" x="393.5" y="147.7993">No</text><rect fill="#F1F1F1" height="88.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="207" x="124" y="173.1982"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="187" x="134" y="196.1934">run_SplitIntervals_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="124" x2="331" y1="204.4951" y2="204.4951"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="175" x="134" y="220.6338">Split reference genome into</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="173" x="134" y="234.6025">interval lists by chomosome</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="186" x="134" y="248.5713">(1-22, X, Y, M, nonassembled)</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="207" x="351" y="173.1982"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="187" x="361" y="196.1934">run_SplitIntervals_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="558" y1="204.4951" y2="204.4951"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="175" x="361" y="220.6338">Split reference genome into</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="97" x="361" y="234.6025">scatter_count</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="75" x="462" y="234.6025">interval lists</text><polygon fill="#F1F1F1" points="341,267.4014,353,279.4014,341,291.4014,329,279.4014,341,267.4014" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="249" x="216.5" y="323.4014"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="160" x="226.5" y="346.3965">run_validate_PipeVal</text><line style="stroke:#181818;stroke-width:1.0;" x1="216.5" x2="465.5" y1="354.6982" y2="354.6982"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="229" x="226.5" y="370.8369">Validate the input BAM and index file</text><rect fill="#F1F1F1" height="102.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="299" x="191.5" y="606.1045"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="218" x="201.5" y="629.0996">run_BaseRecalibrator_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="191.5" x2="490.5" y1="637.4014" y2="637.4014"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="261" x="201.5" y="653.54">Generate base quality score recalibration</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="279" x="201.5" y="667.5088">(BQSR) table based on read group, reported</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="278" x="201.5" y="681.4775">quality score, machine cycle, and nucleotide</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="47" x="201.5" y="695.4463">context</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="285" x="198.5" y="822.5107"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="209" x="208.5" y="845.5059">run_MergeSamFiles_Picard</text><line style="stroke:#181818;stroke-width:1.0;" x1="198.5" x2="483.5" y1="853.8076" y2="853.8076"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="265" x="208.5" y="869.9463">Merge interval BAMS into recalibrated BAM</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="261" x="210.5" y="952.7881"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="241" x="220.5" y="975.7832">deduplicate_records_SAMtools</text><line style="stroke:#181818;stroke-width:1.0;" x1="210.5" x2="471.5" y1="984.085" y2="984.085"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="196" x="220.5" y="1000.2236">Remove duplicate reads due to</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="204" x="220.5" y="1014.1924">overlap on interval splitting sites</text><polygon fill="#F1F1F1" points="300.5,902.7764,381.5,902.7764,393.5,915.5811,381.5,928.3857,300.5,928.3857,288.5,915.5811,300.5,902.7764" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="15" x="345" y="938.5962">No</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="74" x="300.5" y="912.9868">Parallelize by</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="81" x="300.5" y="925.7915">chromosome?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="393.5" y="912.9868">Yes</text><polygon fill="#F1F1F1" points="341,1047.0225,353,1059.0225,341,1071.0225,329,1059.0225,341,1047.0225" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="252" x="215" y="1091.0225"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="157" x="225" y="1114.0176">run_index_SAMtools</text><line style="stroke:#181818;stroke-width:1.0;" x1="215" x2="467" y1="1122.3193" y2="1122.3193"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="232" x="225" y="1138.458">Create index file for recalibrated BAM</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="218" x="232" y="1171.2881"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="135" x="242" y="1194.2832">calculate_sha512</text><line style="stroke:#181818;stroke-width:1.0;" x1="232" x2="450" y1="1202.585" y2="1202.585"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="198" x="242" y="1218.7236">Generate sha512 checksum for</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="193" x="242" y="1232.6924">recalibrated BAM and index file</text><line style="stroke:#181818;stroke-width:1.5;" x1="166" x2="494" y1="1265.5225" y2="1265.5225"/><rect fill="#F1F1F1" height="88.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="273" x="29.5" y="1285.5225"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="248" x="39.5" y="1308.5176">run_GetPileupSummaries_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="29.5" x2="302.5" y1="1316.8193" y2="1316.8193"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="253" x="39.5" y="1332.958">Summarize counts of reads that support</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="241" x="39.5" y="1346.9268">reference, alternate, and other alleles</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="88" x="39.5" y="1360.8955">for given sites</text><rect fill="#F1F1F1" height="116.1406" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="290" x="21" y="1408.7256"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="270" x="31" y="1431.7207">run_CalculateContamination_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="21" x2="311" y1="1440.0225" y2="1440.0225"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="240" x="31" y="1456.1611">Calculate the fraction of reads coming</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="213" x="31" y="1470.1299">from cross-sample contamination.</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="31" y="1484.0986"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="216" x="31" y="1498.0674">If the input is a paired sample, run</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="195" x="31" y="1512.0361">again in matched normal mode</text><rect fill="#F1F1F1" height="88.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="290" x="349" y="1361.8975"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="226" x="359" y="1384.8926">run_DepthOfCoverage_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="349" x2="639" y1="1393.1943" y2="1393.1943"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="270" x="359" y="1409.333">Assess sequence coverage by a wide array</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="235" x="359" y="1423.3018">of metrics, partioned by sample, read</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="111" x="359" y="1437.2705">group, and library</text><polygon fill="#F1F1F1" points="450.5,1311.8857,537.5,1311.8857,549.5,1324.6904,537.5,1337.4951,450.5,1337.4951,438.5,1324.6904,450.5,1311.8857" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="498" y="1347.7056">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="450.5" y="1322.0962">Compute depth</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="73" x="450.5" y="1334.9009">of coverage?</text><polygon fill="#F1F1F1" points="494,1474.5029,506,1486.5029,494,1498.5029,482,1486.5029,494,1474.5029" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:1.5;" x1="166" x2="494" y1="1544.8662" y2="1544.8662"/><ellipse cx="341" cy="1575.8662" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;fill:none;"/><ellipse cx="341" cy="1575.8662" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="15" x2="15" y1="12.7451" y2="1586.8662"/><rect fill="#F1F1F1" height="88.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="291" x="674" y="403.667"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="271" x="684" y="426.6621">run_RealignerTargetCreator_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="674" x2="965" y1="434.9639" y2="434.9639"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="245" x="684" y="451.1025">Split input BAMs by interval and identify</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="237" x="684" y="465.0713">potentially misaligned sub-intervals to</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="195" x="684" y="479.04">target across all input samples</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="217" x="711" y="511.8701"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="197" x="721" y="534.8652">run_IndelRealigner_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="711" x2="928" y1="543.167" y2="543.167"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="187" x="721" y="559.3057">Realign indels across all input</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="149" x="721" y="573.2744">samples simultaneously</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="249" x="695" y="728.2764"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="171" x="705" y="751.2715">run_ApplyBQSR_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="695" x2="944" y1="759.5732" y2="759.5732"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="229" x="705" y="775.7119">Apply the recalibration to each input</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="124" x="705" y="789.6807">sample sequentially</text><line style="stroke:#000000;stroke-width:1.5;" x1="668" x2="668" y1="12.7451" y2="1586.8662"/><line style="stroke:#000000;stroke-width:1.5;" x1="970" x2="970" y1="12.7451" y2="1586.8662"/><line style="stroke:#181818;stroke-width:1.0;" x1="288.5" x2="227.5" y1="150.3936" y2="150.3936"/><line style="stroke:#181818;stroke-width:1.0;" x1="227.5" x2="227.5" y1="150.3936" y2="173.1982"/><polygon fill="#181818" points="223.5,163.1982,227.5,173.1982,231.5,163.1982,227.5,167.1982" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="393.5" x2="454.5" y1="150.3936" y2="150.3936"/><line style="stroke:#181818;stroke-width:1.0;" x1="454.5" x2="454.5" y1="150.3936" y2="173.1982"/><polygon fill="#181818" points="450.5,163.1982,454.5,173.1982,458.5,163.1982,454.5,167.1982" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="227.5" x2="227.5" y1="261.4014" y2="279.4014"/><line style="stroke:#181818;stroke-width:1.0;" x1="227.5" x2="329" y1="279.4014" y2="279.4014"/><polygon fill="#181818" points="319,275.4014,329,279.4014,319,283.4014,323,279.4014" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="454.5" x2="454.5" y1="247.4326" y2="279.4014"/><line style="stroke:#181818;stroke-width:1.0;" x1="454.5" x2="353" y1="279.4014" y2="279.4014"/><polygon fill="#181818" points="363,275.4014,353,279.4014,363,283.4014,359,279.4014" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="341" y1="58.6982" y2="137.5889"/><polygon fill="#181818" points="337,127.5889,341,137.5889,345,127.5889,341,131.5889" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="341" y1="291.4014" y2="323.4014"/><polygon fill="#181818" points="337,313.4014,341,323.4014,345,313.4014,341,317.4014" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="341" y1="928.3857" y2="952.7881"/><polygon fill="#181818" points="337,942.7881,341,952.7881,345,942.7881,341,946.7881" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="393.5" x2="481.5" y1="915.5811" y2="915.5811"/><polygon fill="#181818" points="477.5,979.5029,481.5,989.5029,485.5,979.5029,481.5,983.5029" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="481.5" x2="481.5" y1="915.5811" y2="1059.0225"/><line style="stroke:#181818;stroke-width:1.0;" x1="481.5" x2="353" y1="1059.0225" y2="1059.0225"/><polygon fill="#181818" points="363,1055.0225,353,1059.0225,363,1063.0225,359,1059.0225" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="341" y1="1027.0225" y2="1047.0225"/><polygon fill="#181818" points="337,1037.0225,341,1047.0225,345,1037.0225,341,1041.0225" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="341" y1="882.7764" y2="902.7764"/><polygon fill="#181818" points="337,892.7764,341,902.7764,345,892.7764,341,896.7764" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="341" y1="1071.0225" y2="1091.0225"/><polygon fill="#181818" points="337,1081.0225,341,1091.0225,345,1081.0225,341,1085.0225" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="341" y1="1151.2881" y2="1171.2881"/><polygon fill="#181818" points="337,1161.2881,341,1171.2881,345,1161.2881,341,1165.2881" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="166" x2="166" y1="1373.7256" y2="1408.7256"/><polygon fill="#181818" points="162,1398.7256,166,1408.7256,170,1398.7256,166,1402.7256" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="494" x2="494" y1="1337.4951" y2="1361.8975"/><polygon fill="#181818" points="490,1351.8975,494,1361.8975,498,1351.8975,494,1355.8975" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="649" y1="1324.6904" y2="1324.6904"/><polygon fill="#181818" points="645,1395.5967,649,1405.5967,653,1395.5967,649,1399.5967" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="649" x2="649" y1="1324.6904" y2="1486.5029"/><line style="stroke:#181818;stroke-width:1.0;" x1="649" x2="506" y1="1486.5029" y2="1486.5029"/><polygon fill="#181818" points="516,1482.5029,506,1486.5029,516,1490.5029,512,1486.5029" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="494" x2="494" y1="1450.1006" y2="1474.5029"/><polygon fill="#181818" points="490,1464.5029,494,1474.5029,498,1464.5029,494,1468.5029" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="166" x2="166" y1="1267.0225" y2="1285.5225"/><polygon fill="#181818" points="162,1275.5225,166,1285.5225,170,1275.5225,166,1279.5225" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="494" x2="494" y1="1267.0225" y2="1311.8857"/><polygon fill="#181818" points="490,1301.8857,494,1311.8857,498,1301.8857,494,1305.8857" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="166" x2="166" y1="1524.8662" y2="1544.8662"/><polygon fill="#181818" points="162,1534.8662,166,1544.8662,170,1534.8662,166,1538.8662" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="494" x2="494" y1="1498.5029" y2="1544.8662"/><polygon fill="#181818" points="490,1534.8662,494,1544.8662,498,1534.8662,494,1538.8662" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="341" y1="1245.5225" y2="1265.5225"/><polygon fill="#181818" points="337,1255.5225,341,1265.5225,345,1255.5225,341,1259.5225" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="341" y1="1546.3662" y2="1564.8662"/><polygon fill="#181818" points="337,1554.8662,341,1564.8662,345,1554.8662,341,1558.8662" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="819.5" x2="819.5" y1="491.8701" y2="511.8701"/><polygon fill="#181818" points="815.5,501.8701,819.5,511.8701,823.5,501.8701,819.5,505.8701" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="341" y1="383.667" y2="388.667"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="819.5" y1="388.667" y2="388.667"/><line style="stroke:#181818;stroke-width:1.0;" x1="819.5" x2="819.5" y1="388.667" y2="403.667"/><polygon fill="#181818" points="815.5,393.667,819.5,403.667,823.5,393.667,819.5,397.667" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="819.5" x2="819.5" y1="586.1045" y2="591.1045"/><line style="stroke:#181818;stroke-width:1.0;" x1="819.5" x2="341" y1="591.1045" y2="591.1045"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="341" y1="591.1045" y2="606.1045"/><polygon fill="#181818" points="337,596.1045,341,606.1045,345,596.1045,341,600.1045" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="341" y1="708.2764" y2="713.2764"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="819.5" y1="713.2764" y2="713.2764"/><line style="stroke:#181818;stroke-width:1.0;" x1="819.5" x2="819.5" y1="713.2764" y2="728.2764"/><polygon fill="#181818" points="815.5,718.2764,819.5,728.2764,823.5,718.2764,819.5,722.2764" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="819.5" x2="819.5" y1="802.5107" y2="807.5107"/><line style="stroke:#181818;stroke-width:1.0;" x1="819.5" x2="341" y1="807.5107" y2="807.5107"/><line style="stroke:#181818;stroke-width:1.0;" x1="341" x2="341" y1="807.5107" y2="822.5107"/><polygon fill="#181818" points="337,812.5107,341,822.5107,345,812.5107,341,816.5107" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="226" x="231.5" y="29.4531">Parallelized by sample</text><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="233" x="705.5" y="29.4531">Parallelized by interval</text><!--MD5=[bd917c3daaa5ba1667950e561d37ac01]
@startuml

skinparam SwimlaneTitleFontStyle bold


|s| Parallelized by sample
|i| Parallelized by interval


|s|

start

partition "**Unparallelized Setup**\nThis block is run once\nregardless of sample count" {
    if (Parallelize by\nchromosome?) is (Yes) then
        :==run_SplitIntervals_GATK
        - - - -
        Split reference genome into
        interval lists by chomosome
        (1-22, X, Y, M, nonassembled);
    else (No)
        :==run_SplitIntervals_GATK
        - - - -
        Split reference genome into
        **scatter_count** interval lists;
    endif
}

:==run_validate_PipeVal
- - - -
Validate the input BAM and index file;


|i|

:==run_RealignerTargetCreator_GATK
- - - -
Split input BAMs by interval and identify
potentially misaligned sub-intervals to
target across all input samples;

:==run_IndelRealigner_GATK
- - - -
Realign indels across all input
samples simultaneously;

|s|

:==run_BaseRecalibrator_GATK
- - - -
Generate base quality score recalibration
(BQSR) table based on read group, reported
quality score, machine cycle, and nucleotide
context;

|i|

:==run_ApplyBQSR_GATK
- - - -
Apply the recalibration to each input
sample sequentially;

|s|

:==run_MergeSamFiles_Picard
- - - -
Merge interval BAMS into recalibrated BAM;

if (Parallelize by\nchromosome?) is (No) then
    :==deduplicate_records_SAMtools
    - - - -
    Remove duplicate reads due to 
    overlap on interval splitting sites;
else (Yes)
endif

:==run_index_SAMtools
- - - -
Create index file for recalibrated BAM;

:==calculate_sha512
- - - -
Generate sha512 checksum for
recalibrated BAM and index file;

split
    :==run_GetPileupSummaries_GATK
    - - - -
    Summarize counts of reads that support
    reference, alternate, and other alleles
    for given sites;

    :==run_CalculateContamination_GATK
    - - - -
    Calculate the fraction of reads coming
    from cross-sample contamination.

    If the input is a paired sample, run
    again in matched normal mode;
split again
    if (Compute depth\nof coverage?) is (Yes) then
        :==run_DepthOfCoverage_GATK
        - - - -
        Assess sequence coverage by a wide array
        of metrics, partioned by sample, read
        group, and library;
    endif
end split

stop


@enduml

PlantUML version 1.2022.6(Tue Jun 21 17:34:49 GMT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>