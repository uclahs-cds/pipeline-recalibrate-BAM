<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1814px" preserveAspectRatio="none" style="width:1530px;height:1814px;background:#FFFFFF;" version="1.1" viewBox="0 0 1530 1814" width="1530px" zoomAndPan="magnify"><defs/><g><ellipse cx="460.5" cy="48.6982" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><rect fill="none" height="234.7031" style="stroke:#000000;stroke-width:1.5;" width="474" x="223.5" y="68.6982"/><path d="M421.5,68.6982 L421.5,110.5889 L411.5,120.5889 L223.5,120.5889 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="162" x="226.5" y="82.6934">Unparallelized Setup</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151" x="226.5" y="98.9902">This block is run once</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="188" x="226.5" y="115.2871">regardless of sample count</text><polygon fill="#F1F1F1" points="420,137.5889,501,137.5889,513,150.3936,501,163.1982,420,163.1982,408,150.3936,420,137.5889" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="74" x="420" y="147.7993">Parallelize by</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="81" x="420" y="160.604">chromosome?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="387" y="147.7993">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="15" x="513" y="147.7993">No</text><rect fill="#F1F1F1" height="88.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="207" x="243.5" y="173.1982"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="187" x="253.5" y="196.1934">run_SplitIntervals_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="243.5" x2="450.5" y1="204.4951" y2="204.4951"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="175" x="253.5" y="220.6338">Split reference genome into</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="173" x="253.5" y="234.6025">interval lists by chomosome</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="186" x="253.5" y="248.5713">(1-22, X, Y, M, nonassembled)</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="207" x="470.5" y="173.1982"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="187" x="480.5" y="196.1934">run_SplitIntervals_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="470.5" x2="677.5" y1="204.4951" y2="204.4951"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="175" x="480.5" y="220.6338">Split reference genome into</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="97" x="480.5" y="234.6025">scatter_count</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="75" x="581.5" y="234.6025">interval lists</text><polygon fill="#F1F1F1" points="460.5,267.4014,472.5,279.4014,460.5,291.4014,448.5,279.4014,460.5,267.4014" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="249" x="336" y="323.4014"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="160" x="346" y="346.3965">run_validate_PipeVal</text><line style="stroke:#181818;stroke-width:1.0;" x1="336" x2="585" y1="354.6982" y2="354.6982"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="229" x="346" y="370.8369">Validate the input BAM and index file</text><line style="stroke:#181818;stroke-width:1.5;" x1="285.25" x2="761" y1="1021.3623" y2="1021.3623"/><rect fill="none" height="385.6406" style="stroke:#000000;stroke-width:1.5;" width="565" x="21" y="1031.3623"/><path d="M122,1031.3623 L122,1040.6592 L112,1050.6592 L21,1050.6592 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="24" y="1045.3574">BAM Merging</text><polygon fill="#F1F1F1" points="244.75,1067.6592,325.75,1067.6592,337.75,1080.4639,325.75,1093.2686,244.75,1093.2686,232.75,1080.4639,244.75,1067.6592" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="74" x="244.75" y="1077.8696">Parallelize by</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="81" x="244.75" y="1090.6743">chromosome?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="211.75" y="1077.8696">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="15" x="337.75" y="1077.8696">No</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="228" x="33" y="1103.2686"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="208" x="43" y="1126.2637">run_GatherBamFiles_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="33" x2="261" y1="1134.5654" y2="1134.5654"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="156" x="43" y="1150.7041">Gather BAM files through</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="91" x="43" y="1164.6729">concatenation</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="285" x="281" y="1103.2686"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="209" x="291" y="1126.2637">run_MergeSamFiles_Picard</text><line style="stroke:#181818;stroke-width:1.0;" x1="281" x2="566" y1="1134.5654" y2="1134.5654"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="265" x="291" y="1150.7041">Merge interval BAMS into recalibrated BAM</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="261" x="293" y="1197.5029"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="241" x="303" y="1220.498">deduplicate_records_SAMtools</text><line style="stroke:#181818;stroke-width:1.0;" x1="293" x2="554" y1="1228.7998" y2="1228.7998"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="196" x="303" y="1244.9385">Remove duplicate reads due to</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="204" x="303" y="1258.9072">overlap on interval splitting sites</text><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="252" x="297.5" y="1306.7373"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="157" x="307.5" y="1329.7324">run_index_SAMtools</text><line style="stroke:#181818;stroke-width:1.0;" x1="297.5" x2="549.5" y1="1338.0342" y2="1338.0342"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="232" x="307.5" y="1354.1729">Create index file for recalibrated BAM</text><polygon fill="#F1F1F1" points="285.25,1373.0029,297.25,1385.0029,285.25,1397.0029,273.25,1385.0029,285.25,1373.0029" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="218" x="176.25" y="1448.749"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="135" x="186.25" y="1471.7441">calculate_sha512</text><line style="stroke:#181818;stroke-width:1.0;" x1="176.25" x2="394.25" y1="1480.0459" y2="1480.0459"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="198" x="186.25" y="1496.1846">Generate sha512 checksum for</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="193" x="186.25" y="1510.1533">recalibrated BAM and index file</text><rect fill="#F1F1F1" height="88.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="290" x="140.25" y="1607.9951"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="226" x="150.25" y="1630.9902">run_DepthOfCoverage_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="140.25" x2="430.25" y1="1639.292" y2="1639.292"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="270" x="150.25" y="1655.4307">Assess sequence coverage by a wide array</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="235" x="150.25" y="1669.3994">of metrics, partioned by sample, read</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="111" x="150.25" y="1683.3682">group, and library</text><polygon fill="#F1F1F1" points="241.75,1557.9834,328.75,1557.9834,340.75,1570.7881,328.75,1583.5928,241.75,1583.5928,229.75,1570.7881,241.75,1557.9834" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="289.25" y="1593.8032">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="241.75" y="1568.1938">Compute depth</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="73" x="241.75" y="1580.9985">of coverage?</text><polygon fill="#F1F1F1" points="285.25,1716.1982,297.25,1728.1982,285.25,1740.1982,273.25,1728.1982,285.25,1716.1982" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="60.2656" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="294" x="614" y="1344.9912"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="274" x="624" y="1367.9863">run_GatherPileupSummaries_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="614" x2="908" y1="1376.2881" y2="1376.2881"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="239" x="624" y="1392.4268">Gather interval-level pileup summaries</text><rect fill="#F1F1F1" height="116.1406" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="290" x="616" y="1437.0029"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="270" x="626" y="1459.998">run_CalculateContamination_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="616" x2="906" y1="1468.2998" y2="1468.2998"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="240" x="626" y="1484.4385">Calculate the fraction of reads coming</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="213" x="626" y="1498.4072">from cross-sample contamination.</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="626" y="1512.376"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="216" x="626" y="1526.3447">If the input is a paired sample, run</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="195" x="626" y="1540.3135">again in matched normal mode</text><line style="stroke:#181818;stroke-width:1.5;" x1="285.25" x2="761" y1="1760.1982" y2="1760.1982"/><ellipse cx="460.5" cy="1791.1982" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;fill:none;"/><ellipse cx="460.5" cy="1791.1982" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.5;" x1="15" x2="15" y1="12.7451" y2="1802.1982"/><rect fill="#F1F1F1" height="88.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="291" x="923" y="452.0693"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="271" x="933" y="475.0645">run_RealignerTargetCreator_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="923" x2="1214" y1="483.3662" y2="483.3662"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="245" x="933" y="499.5049">Split input BAMs by interval and identify</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="237" x="933" y="513.4736">potentially misaligned sub-intervals to</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="195" x="933" y="527.4424">target across all input samples</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="217" x="960" y="570.7881"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="197" x="970" y="593.7832">run_IndelRealigner_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="960" x2="1177" y1="602.085" y2="602.085"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="187" x="970" y="618.2236">Realign indels across all input</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="149" x="970" y="632.1924">samples simultaneously</text><polygon fill="#F1F1F1" points="1005.5,403.667,1131.5,403.667,1143.5,415.667,1131.5,427.667,1005.5,427.667,993.5,415.667,1005.5,403.667" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="1072.5" y="437.8774">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="126" x="1005.5" y="419.4751">run_indelrealignment?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="15" x="1143.5" y="413.0728">No</text><polygon fill="#F1F1F1" points="1068.5,665.0225,1080.5,677.0225,1068.5,689.0225,1056.5,677.0225,1068.5,665.0225" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="102.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="299" x="919" y="757.4248"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="218" x="929" y="780.4199">run_BaseRecalibrator_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="919" x2="1218" y1="788.7217" y2="788.7217"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="261" x="929" y="804.8604">Generate base quality score recalibration</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="279" x="929" y="818.8291">(BQSR) table based on read group, reported</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="278" x="929" y="832.7979">quality score, machine cycle, and nucleotide</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="47" x="929" y="846.7666">context</text><rect fill="#F1F1F1" height="74.2344" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="249" x="944" y="883.1279"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="171" x="954" y="906.123">run_ApplyBQSR_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="944" x2="1193" y1="914.4248" y2="914.4248"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="229" x="954" y="930.5635">Apply the recalibration to each input</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="124" x="954" y="944.5322">sample sequentially</text><polygon fill="#F1F1F1" points="1003.5,709.0225,1133.5,709.0225,1145.5,721.0225,1133.5,733.0225,1003.5,733.0225,991.5,721.0225,1003.5,709.0225" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="1072.5" y="743.2329">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="130" x="1003.5" y="724.8306">run_baserecalibration?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="15" x="1145.5" y="718.4282">No</text><polygon fill="#F1F1F1" points="1068.5,977.3623,1080.5,989.3623,1068.5,1001.3623,1056.5,989.3623,1068.5,977.3623" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F1F1F1" height="88.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="273" x="1232.5" y="1221.7881"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="248" x="1242.5" y="1244.7832">run_GetPileupSummaries_GATK</text><line style="stroke:#181818;stroke-width:1.0;" x1="1232.5" x2="1505.5" y1="1253.085" y2="1253.085"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="253" x="1242.5" y="1269.2236">Summarize counts of reads that support</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="241" x="1242.5" y="1283.1924">reference, alternate, and other alleles</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="88" x="1242.5" y="1297.1611">for given sites</text><line style="stroke:#000000;stroke-width:1.5;" x1="913" x2="913" y1="12.7451" y2="1802.1982"/><line style="stroke:#000000;stroke-width:1.5;" x1="1510.5" x2="1510.5" y1="12.7451" y2="1802.1982"/><line style="stroke:#181818;stroke-width:1.0;" x1="408" x2="347" y1="150.3936" y2="150.3936"/><line style="stroke:#181818;stroke-width:1.0;" x1="347" x2="347" y1="150.3936" y2="173.1982"/><polygon fill="#181818" points="343,163.1982,347,173.1982,351,163.1982,347,167.1982" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="513" x2="574" y1="150.3936" y2="150.3936"/><line style="stroke:#181818;stroke-width:1.0;" x1="574" x2="574" y1="150.3936" y2="173.1982"/><polygon fill="#181818" points="570,163.1982,574,173.1982,578,163.1982,574,167.1982" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="347" x2="347" y1="261.4014" y2="279.4014"/><line style="stroke:#181818;stroke-width:1.0;" x1="347" x2="448.5" y1="279.4014" y2="279.4014"/><polygon fill="#181818" points="438.5,275.4014,448.5,279.4014,438.5,283.4014,442.5,279.4014" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="574" x2="574" y1="247.4326" y2="279.4014"/><line style="stroke:#181818;stroke-width:1.0;" x1="574" x2="472.5" y1="279.4014" y2="279.4014"/><polygon fill="#181818" points="482.5,275.4014,472.5,279.4014,482.5,283.4014,478.5,279.4014" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="460.5" x2="460.5" y1="58.6982" y2="137.5889"/><polygon fill="#181818" points="456.5,127.5889,460.5,137.5889,464.5,127.5889,460.5,131.5889" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="460.5" x2="460.5" y1="291.4014" y2="323.4014"/><polygon fill="#181818" points="456.5,313.4014,460.5,323.4014,464.5,313.4014,460.5,317.4014" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="423.5" x2="423.5" y1="1163.5342" y2="1197.5029"/><polygon fill="#181818" points="419.5,1187.5029,423.5,1197.5029,427.5,1187.5029,423.5,1191.5029" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="423.5" x2="423.5" y1="1271.7373" y2="1306.7373"/><polygon fill="#181818" points="419.5,1296.7373,423.5,1306.7373,427.5,1296.7373,423.5,1300.7373" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="232.75" x2="147" y1="1080.4639" y2="1080.4639"/><line style="stroke:#181818;stroke-width:1.0;" x1="147" x2="147" y1="1080.4639" y2="1103.2686"/><polygon fill="#181818" points="143,1093.2686,147,1103.2686,151,1093.2686,147,1097.2686" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="337.75" x2="423.5" y1="1080.4639" y2="1080.4639"/><line style="stroke:#181818;stroke-width:1.0;" x1="423.5" x2="423.5" y1="1080.4639" y2="1103.2686"/><polygon fill="#181818" points="419.5,1093.2686,423.5,1103.2686,427.5,1093.2686,423.5,1097.2686" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="147" x2="147" y1="1177.5029" y2="1385.0029"/><line style="stroke:#181818;stroke-width:1.0;" x1="147" x2="273.25" y1="1385.0029" y2="1385.0029"/><polygon fill="#181818" points="263.25,1381.0029,273.25,1385.0029,263.25,1389.0029,267.25,1385.0029" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="423.5" x2="423.5" y1="1367.0029" y2="1385.0029"/><line style="stroke:#181818;stroke-width:1.0;" x1="423.5" x2="297.25" y1="1385.0029" y2="1385.0029"/><polygon fill="#181818" points="307.25,1381.0029,297.25,1385.0029,307.25,1389.0029,303.25,1385.0029" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285.25" x2="285.25" y1="1397.0029" y2="1448.749"/><polygon fill="#181818" points="281.25,1438.749,285.25,1448.749,289.25,1438.749,285.25,1442.749" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285.25" x2="285.25" y1="1583.5928" y2="1607.9951"/><polygon fill="#181818" points="281.25,1597.9951,285.25,1607.9951,289.25,1597.9951,285.25,1601.9951" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="340.75" x2="440.25" y1="1570.7881" y2="1570.7881"/><polygon fill="#181818" points="436.25,1641.6943,440.25,1651.6943,444.25,1641.6943,440.25,1645.6943" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="440.25" x2="440.25" y1="1570.7881" y2="1728.1982"/><line style="stroke:#181818;stroke-width:1.0;" x1="440.25" x2="297.25" y1="1728.1982" y2="1728.1982"/><polygon fill="#181818" points="307.25,1724.1982,297.25,1728.1982,307.25,1732.1982,303.25,1728.1982" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285.25" x2="285.25" y1="1696.1982" y2="1716.1982"/><polygon fill="#181818" points="281.25,1706.1982,285.25,1716.1982,289.25,1706.1982,285.25,1710.1982" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285.25" x2="285.25" y1="1522.9834" y2="1557.9834"/><polygon fill="#181818" points="281.25,1547.9834,285.25,1557.9834,289.25,1547.9834,285.25,1551.9834" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="761" x2="761" y1="1405.2568" y2="1437.0029"/><polygon fill="#181818" points="757,1427.0029,761,1437.0029,765,1427.0029,761,1431.0029" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285.25" x2="285.25" y1="1022.8623" y2="1067.6592"/><polygon fill="#181818" points="281.25,1057.6592,285.25,1067.6592,289.25,1057.6592,285.25,1061.6592" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="285.25" x2="285.25" y1="1740.1982" y2="1760.1982"/><polygon fill="#181818" points="281.25,1750.1982,285.25,1760.1982,289.25,1750.1982,285.25,1754.1982" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="761" x2="761" y1="1553.1436" y2="1760.1982"/><polygon fill="#181818" points="757,1750.1982,761,1760.1982,765,1750.1982,761,1754.1982" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="460.5" x2="460.5" y1="1761.6982" y2="1780.1982"/><polygon fill="#181818" points="456.5,1770.1982,460.5,1780.1982,464.5,1770.1982,460.5,1774.1982" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1068.5" x2="1068.5" y1="540.2725" y2="570.7881"/><polygon fill="#181818" points="1064.5,560.7881,1068.5,570.7881,1072.5,560.7881,1068.5,564.7881" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1068.5" x2="1068.5" y1="427.667" y2="452.0693"/><polygon fill="#181818" points="1064.5,442.0693,1068.5,452.0693,1072.5,442.0693,1068.5,446.0693" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1143.5" x2="1224" y1="415.667" y2="415.667"/><polygon fill="#181818" points="1220,540.7881,1224,550.7881,1228,540.7881,1224,544.7881" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1224" x2="1224" y1="415.667" y2="677.0225"/><line style="stroke:#181818;stroke-width:1.0;" x1="1224" x2="1080.5" y1="677.0225" y2="677.0225"/><polygon fill="#181818" points="1090.5,673.0225,1080.5,677.0225,1090.5,681.0225,1086.5,677.0225" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1068.5" x2="1068.5" y1="645.0225" y2="665.0225"/><polygon fill="#181818" points="1064.5,655.0225,1068.5,665.0225,1072.5,655.0225,1068.5,659.0225" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1068.5" x2="1068.5" y1="859.5967" y2="883.1279"/><polygon fill="#181818" points="1064.5,873.1279,1068.5,883.1279,1072.5,873.1279,1068.5,877.1279" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1068.5" x2="1068.5" y1="733.0225" y2="757.4248"/><polygon fill="#181818" points="1064.5,747.4248,1068.5,757.4248,1072.5,747.4248,1068.5,751.4248" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1145.5" x2="1228" y1="721.0225" y2="721.0225"/><polygon fill="#181818" points="1224,853.1279,1228,863.1279,1232,853.1279,1228,857.1279" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1228" x2="1228" y1="721.0225" y2="989.3623"/><line style="stroke:#181818;stroke-width:1.0;" x1="1228" x2="1080.5" y1="989.3623" y2="989.3623"/><polygon fill="#181818" points="1090.5,985.3623,1080.5,989.3623,1090.5,993.3623,1086.5,989.3623" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1068.5" x2="1068.5" y1="957.3623" y2="977.3623"/><polygon fill="#181818" points="1064.5,967.3623,1068.5,977.3623,1072.5,967.3623,1068.5,971.3623" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1068.5" x2="1068.5" y1="689.0225" y2="709.0225"/><polygon fill="#181818" points="1064.5,699.0225,1068.5,709.0225,1072.5,699.0225,1068.5,703.0225" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="460.5" x2="460.5" y1="383.667" y2="388.667"/><line style="stroke:#181818;stroke-width:1.0;" x1="460.5" x2="1068.5" y1="388.667" y2="388.667"/><line style="stroke:#181818;stroke-width:1.0;" x1="1068.5" x2="1068.5" y1="388.667" y2="403.667"/><polygon fill="#181818" points="1064.5,393.667,1068.5,403.667,1072.5,393.667,1068.5,397.667" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1369" x2="1369" y1="1309.9912" y2="1327.4912"/><line style="stroke:#181818;stroke-width:1.0;" x1="1369" x2="761" y1="1327.4912" y2="1327.4912"/><line style="stroke:#181818;stroke-width:1.0;" x1="761" x2="761" y1="1327.4912" y2="1344.9912"/><polygon fill="#181818" points="757,1334.9912,761,1344.9912,765,1334.9912,761,1338.9912" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="761" x2="761" y1="1022.8623" y2="1026.3623"/><line style="stroke:#181818;stroke-width:1.0;" x1="761" x2="1369" y1="1026.3623" y2="1026.3623"/><line style="stroke:#181818;stroke-width:1.0;" x1="1369" x2="1369" y1="1026.3623" y2="1221.7881"/><polygon fill="#181818" points="1365,1211.7881,1369,1221.7881,1373,1211.7881,1369,1215.7881" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1068.5" x2="1068.5" y1="1001.3623" y2="1006.3623"/><line style="stroke:#181818;stroke-width:1.0;" x1="1068.5" x2="460.5" y1="1006.3623" y2="1006.3623"/><line style="stroke:#181818;stroke-width:1.0;" x1="460.5" x2="460.5" y1="1006.3623" y2="1021.3623"/><polygon fill="#181818" points="456.5,1011.3623,460.5,1021.3623,464.5,1011.3623,460.5,1015.3623" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="226" x="354" y="29.4531">Parallelized by sample</text><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="233" x="1098.25" y="29.4531">Parallelized by interval</text><!--MD5=[2ba703a6e0e8c172f73bf3fad87912b3]
@startuml

skinparam SwimlaneTitleFontStyle bold


|s| Parallelized by sample
|i| Parallelized by interval


|s|

start

partition "**Unparallelized Setup**\nThis block is run once\nregardless of sample count" {
    if (Parallelize by\nchromosome?) is (Yes) then
        :==run_SplitIntervals_GATK
        - - - -
        Split reference genome into
        interval lists by chomosome
        (1-22, X, Y, M, nonassembled);
    else (No)
        :==run_SplitIntervals_GATK
        - - - -
        Split reference genome into
        **scatter_count** interval lists;
    endif
}

:==run_validate_PipeVal
- - - -
Validate the input BAM and index file;


|i|
if (run_indelrealignment?) is (Yes) then
    :==run_RealignerTargetCreator_GATK
    - - - -
    Split input BAMs by interval and identify
    potentially misaligned sub-intervals to
    target across all input samples;

    :==run_IndelRealigner_GATK
    - - - -
    Realign indels across all input
    samples simultaneously;
else (No)
endif

if (run_baserecalibration?) is (Yes) then
    :==run_BaseRecalibrator_GATK
    - - - -
    Generate base quality score recalibration
    (BQSR) table based on read group, reported
    quality score, machine cycle, and nucleotide
    context;

    :==run_ApplyBQSR_GATK
    - - - -
    Apply the recalibration to each input
    sample sequentially;
else (No)
endif

|s|
split
    partition "BAM Merging" {
        if (Parallelize by\nchromosome?) is (Yes) then
            :==run_GatherBamFiles_GATK
            - - - -
            Gather BAM files through
            concatenation;
        else (No)
            :==run_MergeSamFiles_Picard
            - - - -
            Merge interval BAMS into recalibrated BAM;

            :==deduplicate_records_SAMtools
            - - - -
            Remove duplicate reads due to 
            overlap on interval splitting sites;

            :==run_index_SAMtools
            - - - -
            Create index file for recalibrated BAM;
        endif
    }

    :==calculate_sha512
    - - - -
    Generate sha512 checksum for
    recalibrated BAM and index file;

    if (Compute depth\nof coverage?) is (Yes) then
        :==run_DepthOfCoverage_GATK
        - - - -
        Assess sequence coverage by a wide array
        of metrics, partioned by sample, read
        group, and library;
    endif
split again
    |i|
    
    :==run_GetPileupSummaries_GATK
    - - - -
    Summarize counts of reads that support
    reference, alternate, and other alleles
    for given sites;

    |s|

    :==run_GatherPileupSummaries_GATK
    - - - -
    Gather interval-level pileup summaries;

    :==run_CalculateContamination_GATK
    - - - -
    Calculate the fraction of reads coming
    from cross-sample contamination.

    If the input is a paired sample, run
    again in matched normal mode;
end split

stop


@enduml

PlantUML version 1.2022.6(Tue Jun 21 17:34:49 GMT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>